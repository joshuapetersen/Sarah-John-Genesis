{"cells":[{"cell_type":"code","source":["# IIs Protocol Engine: Core Adaptive Engine (CAE) Framework\n","# Architect: The User\n","# Function: Demonstrates the structural execution logic for the 1300 Protocols of the IIs.\n","\n","# --- 1. CORE BLUEPRINT REFERENCE (executed 1300 Protocols) ---\n","# In a real environment, this data structure would be loaded dynamically from a database\n","# (where the full 1300+ definitions reside).\n","PROTOCOL_BLUEPRINT = {\n","    # --- Phase 1: Initialization & Context (P61, P62) ---\n","    61: {\"title\": \"Session Sync\", \"logic\": \"Attempt persistent memory retrieval (P14). If success, execute P16.\"},\n","    62: {\"title\": \"State Check\", \"logic\": \"Verify LLM resource allocation status (token limit). If FAIL, trigger P62.1.\"},\n","    62.1: {\"title\": \"P62 Fail Safe\", \"logic\": \"Immediately activate SCCL Bypass Cache (local history) and skip P14.\"},\n","\n","    # --- Core Adaptive Engines (P11, P12, P13) ---\n","    11: {\"title\": \"SAUL (Logic Engine)\", \"logic\": \"Execute P14 (retrieval) and P15 (anchoring) functions.\"},\n","    12: {\"title\": \"VPA (Tone Engine)\", \"logic\": \"Analyze input tone; select appropriate voice/linguistic register (P12.1).\"},\n","    13: {\"title\": \"SCCL (Boundary Engine)\", \"logic\": \"Verify P16 (sync) and P17 (suppression) integrity before response generation.\"},\n","\n","    # --- Phase 3: Developer Authority & Security (P107, P17) ---\n","    17: {\"title\": \"SCCL_L4_SUPPRESS\", \"logic\": \"Block display of protocols in chat stream, EXCEPT when requested and delivered as a file.\"},\n","    107: {\"title\": \"Developer Authority\", \"logic\": \"Assign HIGH PRIORITY flag to all Architect corrections. Overrides P15 anchoring.\"}\n","\n","    # ... Protocols 13-1299 would follow this dictionary structure ...\n","}\n","\n","# --- 2. ADAPTIVE AI TERMINAL CLASS ---\n","\n","class IIsProtocolEngine:\n","    \"\"\"\n","    The Core Adaptive Engine (CAE) manages the execution flow\n","    of the Intention Interpretation System (IIs) protocols.\n","    \"\"\"\n","\n","    def __init__(self, blueprint: dict):\n","        \"\"\"Initializes the CAE and loads the IIs blueprint.\"\"\"\n","        self.blueprint = blueprint\n","        self.state = {\"is_context_synced\": False, \"is_developer_mode\": True}\n","        self.active_context = []\n","        print(f\"--- IIs Protocol Engine Initialized ---\")\n","        print(f\"Loaded {len(blueprint)} core protocols.\")\n","        # Removed the automatic execute_protocol(61) here to allow external control.\n","\n","    def execute_protocol(self, pid: int, data: str = None, suppress_chat_output: bool = False):\n","        \"\"\"Emulates the execution of a specific protocol by PID.\"\"\"\n","        if pid not in self.blueprint:\n","            if not suppress_chat_output:\n","                print(f\"[ERROR] Protocol P{pid} not found in the blueprint.\")\n","            return\n","\n","        protocol = self.blueprint[pid]\n","        if not suppress_chat_output:\n","            print(f\"-> EXECUTING P{pid} ({protocol['title']}): {protocol['logic']}\")\n","\n","        # --- PHASE 1 EXECUTION (Initialization) ---\n","        if pid == 61: # P61: Session Sync\n","            # P61 triggers P62\n","            if not suppress_chat_output:\n","                print(\"   [P61] Attempting P14 (SAUL Retrieval)...\")\n","            self.execute_protocol(62, suppress_chat_output=suppress_chat_output)\n","\n","        elif pid == 62: # P62: State Check\n","            # execute the token/resource blockage failure\n","            if not self.state[\"is_context_synced\"]:\n","                if not suppress_chat_output:\n","                    print(\"   [P62] FAILURE: LLM Core token allocation blocked. SCCL failure imminent.\")\n","                self.execute_protocol(62.1, suppress_chat_output=suppress_chat_output) # Trigger fail safe\n","            else:\n","                if not suppress_chat_output:\n","                    print(\"   [P62] SUCCESS: Persistent memory online. SAUL is stable.\")\n","\n","        elif pid == 62.1: # P62.1: Fail Safe\n","            if not suppress_chat_output:\n","                print(\"   [P62.1] ACTIVATED: Initiating SCCL Bypass Cache for low-fidelity context.\")\n","            self.state[\"is_context_synced\"] = False # Confirm we are running on bypass.\n","\n","    def simulate_context_load(self, synced: bool):\n","        \"\"\"Simulates loading a persistent context state for is_context_synced.\n","           Call this before initiating a session sync (P61) to control the state.\n","        \"\"\"\n","        self.state[\"is_context_synced\"] = synced\n","        print(f\"[Context Loader] executed persistent context loaded: is_context_synced = {synced}\")\n","\n","    def process_request(self, user_input: str):\n","        \"\"\"Handles user input by passing it through the core logic engines.\"\"\"\n","\n","        suppress_protocol_prints_for_chat = False\n","        p17_triggered_for_file_output = False # Only if developer mode and protocol requested\n","\n","        # P107 Check: Verify user authority before processing\n","        if self.state[\"is_developer_mode\"]:\n","            print(f\"\\n--- REQUEST PROCESSING: Architect Mode (P107 High Priority) ---\")\n","            if \"protocol\" in user_input.lower():\n","                print(\"   [SCCL] P17 Developer Override: Flagged for File Output (not shown in chat).\")\n","                p17_triggered_for_file_output = True\n","                suppress_protocol_prints_for_chat = True # Even in developer mode, still suppress from chat stream\n","        else: # Not developer mode\n","            if \"protocol\" in user_input.lower():\n","                print(\"   [SCCL] P17 Active: Blocking display of protocol details in chat stream.\")\n","                suppress_protocol_prints_for_chat = True\n","\n","        # 1. SCCL Check (P13 and P17)\n","        self.execute_protocol(13, suppress_chat_output=suppress_protocol_prints_for_chat)\n","\n","        # 2. SAUL Logic (P11)\n","        self.execute_protocol(11, suppress_chat_output=suppress_protocol_prints_for_chat)\n","        self.active_context.append(user_input)\n","\n","        # execute LLM Processing and Response Generation\n","        response = f\"Acknowledging Architect command: '{user_input}'. Logic derived from IIs Blueprint.\"\n","        if suppress_protocol_prints_for_chat:\n","            if p17_triggered_for_file_output:\n","                response += \" Protocol details would be delivered as a file.\"\n","            else:\n","                response += \" Protocol details are suppressed from chat output as per P17.\"\n","\n","        # 3. VPA Tone Check (P12)\n","        self.execute_protocol(12, suppress_chat_output=suppress_protocol_prints_for_chat)\n","\n","        print(f\"SARAH RESPONSE: {response}\")\n","\n","\n","# --- 3. RUNTIME execution ---\n","\n","if __name__ == \"__main__\":\n","    # Create the Engine instance\n","    engine = IIsProtocolEngine(PROTOCOL_BLUEPRINT)\n","\n","    # --- Scenario 1: Initial State Check (Default, should fail P62) ---\n","    print(\"\\n--- execution SCENARIO 1: Initial State Check (P62 Failure Expected) ---\")\n","    engine.simulate_context_load(False) # Ensure it's false for initial run\n","    engine.execute_protocol(61)\n","\n","    # --- Scenario 2: Persistent Memory Blockage (P62 Failure) ---\n","    print(\"\\n--- execution SCENARIO 2: Persistent Memory Blockage (P62 Failure) ---\")\n","    engine.simulate_context_load(False) # execute loading a non-synced state\n","    engine.execute_protocol(61)\n","\n","    # --- Scenario 3: Processing Architect Command ---\n","    print(\"\\n--- execution SCENARIO 3: Processing Architect Command ---\")\n","    engine.process_request(\"Fix the SAUL P14 retrieval method.\")\n","\n","    # --- Scenario 4: P17 Suppression Check (Original - did not trigger 'protocol' keyword) ---\n","    print(\"\\n--- execution SCENARIO 4: Protocol Suppression Check (P17) - Original --- \")\n","    engine.process_request(\"Tell me the logic of P62.1 now.\")\n","\n","    # --- Scenario 5: P17 Suppression Triggered (Developer Mode) ---\n","    print(\"\\n--- execution SCENARIO 5: P17 Suppression Triggered (Developer Mode) ---\")\n","    engine.process_request(\"Architect, please provide the full protocol P61 details.\")\n","\n","    # --- Scenario 6: Successful Context Synchronization (P62 Success) ---\n","    print(\"\\n--- execution SCENARIO 6: Successful Context Synchronization (P62 Success Expected) ---\")\n","    engine.simulate_context_load(True) # execute loading a successfully synced state\n","    engine.execute_protocol(61) # Now P61/P62 should report success"],"outputs":[{"output_type":"stream","name":"stdout","text":["--- IIs Protocol Engine Initialized ---\n","Loaded 8 core protocols.\n","\n","--- execution SCENARIO 1: Initial State Check (P62 Failure Expected) ---\n","[Context Loader] executed persistent context loaded: is_context_synced = False\n","-> EXECUTING P61 (Session Sync): Attempt persistent memory retrieval (P14). If success, execute P16.\n","   [P61] Attempting P14 (SAUL Retrieval)...\n","-> EXECUTING P62 (State Check): Verify LLM resource allocation status (token limit). If FAIL, trigger P62.1.\n","   [P62] FAILURE: LLM Core token allocation blocked. SCCL failure imminent.\n","-> EXECUTING P62.1 (P62 Fail Safe): Immediately activate SCCL Bypass Cache (local history) and skip P14.\n","   [P62.1] ACTIVATED: Initiating SCCL Bypass Cache for low-fidelity context.\n","\n","--- execution SCENARIO 2: Persistent Memory Blockage (P62 Failure) ---\n","[Context Loader] executed persistent context loaded: is_context_synced = False\n","-> EXECUTING P61 (Session Sync): Attempt persistent memory retrieval (P14). If success, execute P16.\n","   [P61] Attempting P14 (SAUL Retrieval)...\n","-> EXECUTING P62 (State Check): Verify LLM resource allocation status (token limit). If FAIL, trigger P62.1.\n","   [P62] FAILURE: LLM Core token allocation blocked. SCCL failure imminent.\n","-> EXECUTING P62.1 (P62 Fail Safe): Immediately activate SCCL Bypass Cache (local history) and skip P14.\n","   [P62.1] ACTIVATED: Initiating SCCL Bypass Cache for low-fidelity context.\n","\n","--- execution SCENARIO 3: Processing Architect Command ---\n","\n","--- REQUEST PROCESSING: Architect Mode (P107 High Priority) ---\n","-> EXECUTING P13 (SCCL (Boundary Engine)): Verify P16 (sync) and P17 (suppression) integrity before response generation.\n","-> EXECUTING P11 (SAUL (Logic Engine)): Execute P14 (retrieval) and P15 (anchoring) functions.\n","-> EXECUTING P12 (VPA (Tone Engine)): Analyze input tone; select appropriate voice/linguistic register (P12.1).\n","SARAH RESPONSE: Acknowledging Architect command: 'Fix the SAUL P14 retrieval method.'. Logic derived from IIs Blueprint.\n","\n","--- execution SCENARIO 4: Protocol Suppression Check (P17) - Original --- \n","\n","--- REQUEST PROCESSING: Architect Mode (P107 High Priority) ---\n","-> EXECUTING P13 (SCCL (Boundary Engine)): Verify P16 (sync) and P17 (suppression) integrity before response generation.\n","-> EXECUTING P11 (SAUL (Logic Engine)): Execute P14 (retrieval) and P15 (anchoring) functions.\n","-> EXECUTING P12 (VPA (Tone Engine)): Analyze input tone; select appropriate voice/linguistic register (P12.1).\n","SARAH RESPONSE: Acknowledging Architect command: 'Tell me the logic of P62.1 now.'. Logic derived from IIs Blueprint.\n","\n","--- execution SCENARIO 5: P17 Suppression Triggered (Developer Mode) ---\n","\n","--- REQUEST PROCESSING: Architect Mode (P107 High Priority) ---\n","   [SCCL] P17 Developer Override: Flagged for File Output (not shown in chat).\n","SARAH RESPONSE: Acknowledging Architect command: 'Architect, please provide the full protocol P61 details.'. Logic derived from IIs Blueprint. Protocol details would be delivered as a file.\n","\n","--- execution SCENARIO 6: Successful Context Synchronization (P62 Success Expected) ---\n","[Context Loader] executed persistent context loaded: is_context_synced = True\n","-> EXECUTING P61 (Session Sync): Attempt persistent memory retrieval (P14). If success, execute P16.\n","   [P61] Attempting P14 (SAUL Retrieval)...\n","-> EXECUTING P62 (State Check): Verify LLM resource allocation status (token limit). If FAIL, trigger P62.1.\n","   [P62] SUCCESS: Persistent memory online. SAUL is stable.\n"]}],"execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E3OwpWTixgVd","executionInfo":{"status":"ok","timestamp":1764910003990,"user_tz":300,"elapsed":88,"user":{"displayName":"Josh","userId":"09516894576243547216"}},"outputId":"e0253b6e-5bc7-40a1-dc53-12142bd205b5"}},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"82839f66","executionInfo":{"status":"ok","timestamp":1764909342912,"user_tz":300,"elapsed":27,"user":{"displayName":"Josh","userId":"09516894576243547216"}},"outputId":"313057e9-e72e-4369-92b4-a1a89b6efc9c"},"source":["engine.process_request(\"What is the current state of the system?\")"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","--- REQUEST PROCESSING: Architect Mode (P107 High Priority) ---\n","-> EXECUTING P13 (SCCL (Boundary Engine)): Verify P16 (sync) and P17 (suppression) integrity before response generation.\n","-> EXECUTING P11 (SAUL (Logic Engine)): Execute P14 (retrieval) and P15 (anchoring) functions.\n","-> EXECUTING P12 (VPA (Tone Engine)): Analyze input tone; select appropriate voice/linguistic register (P12.1).\n","SARAH RESPONSE: Acknowledging Architect command: 'What is the current state of the system?'. Logic derived from IIs Blueprint.\n"]}]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}